{ pkgs, ... }:
with pkgs;
with pkgs.lib;
let
  proc = import ./proc/default.nix { inherit pkgs; };
  main_layout = import ./main.kdl.nix { inherit pkgs proc; };
in
pkgs.stdenv.mkDerivation {
  name = "zashboard";
  src = ./.;
  buildInputs = [
    proc
  ];
  buildPhase = ''
    # user config
    # dev config
    cat ${./proc/php.sh} > php.sh
  '';
  installPhase = ''
    mkdir -p $out/bin
    touch $out/bin/zashboard
    chmod +x $out/bin/zashboard
    echo "${getExe zellij} --layout ${main_layout}" > $out/bin/zashboard
  '';
}
